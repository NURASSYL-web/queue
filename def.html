<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û—á–µ—Ä–µ–¥—å —Å–¥–∞—á–∏ - –û–±—â–∞—è</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 400px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f0f0f0;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        button {
            width: 100%;
            padding: 15px;
            font-size: 18px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 0;
        }
        button:disabled {
            background: #cccccc;
        }
        .admin-btn {
            background: #ff4444;
        }
        .queue-list {
            margin-top: 20px;
        }
        .queue-item {
            padding: 10px;
            margin: 5px 0;
            background: #f8f8f8;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
        }
        .number {
            font-weight: bold;
            color: #4CAF50;
        }
        .timestamp {
            color: #666;
            font-size: 12px;
        }
        .admin-panel {
            margin-top: 20px;
            padding: 15px;
            background: #fff3cd;
            border-radius: 5px;
            display: none;
        }
        .share-link {
            background: #e7f3ff;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            word-break: break-all;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>–û—á–µ—Ä–µ–¥—å —Å–¥–∞—á–∏ üéØ</h1>
        <div id="status"></div>
        <button id="joinBtn" onclick="joinQueue()">–Ø —Å–¥–∞—é! (+)</button>
        
        <div class="queue-list">
            <h3>–û—á–µ—Ä–µ–¥—å:</h3>
            <div id="queueContainer"></div>
        </div>

        <button onclick="toggleAdmin()" class="admin-btn">–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</button>
        
        <div class="admin-panel" id="adminPanel">
            <h3>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h3>
            <p>–¢–æ–ª—å–∫–æ –≤—ã –º–æ–∂–µ—Ç–µ —Å–±—Ä–∞—Å—ã–≤–∞—Ç—å –æ—á–µ—Ä–µ–¥—å</p>
            <button onclick="resetQueue()">–°–±—Ä–æ—Å–∏—Ç—å –æ—á–µ—Ä–µ–¥—å</button>
            <button onclick="clearMyQueue()">–£–±—Ä–∞—Ç—å –º–µ–Ω—è –∏–∑ –æ—á–µ—Ä–µ–¥–∏</button>
            
            <div style="margin-top: 15px;">
                <h4>–ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Å—Å—ã–ª–∫–æ–π:</h4>
                <div class="share-link" id="shareLink">
                    –ó–∞–≥—Ä—É–∑–∫–∞...
                </div>
                <button onclick="copyShareLink()">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É</button>
            </div>
        </div>
    </div>

    <script>

 // Import the functions you need from the SDKs you need
import { initializeApp } from "firebase/app";
// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries

// Your web app's Firebase configuration
const firebaseConfig = {
  apiKey: "AIzaSyDDRvLd3fHTfe7nYID1tGMSTJ9g3urtQZI",
  authDomain: "queue-2f3.firebaseapp.com",
  databaseURL: "https://queue-2f3-default-rtdb.firebaseio.com",
  projectId: "queue-2f3",
  storageBucket: "queue-2f3.firebasestorage.app",
  messagingSenderId: "534834732526",
  appId: "1:534834732526:web:dffd437bc37a0dd21182ff"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–¥–º–∏–Ω–∞ - –ó–ê–ú–ï–ù–ò–¢–ï –≠–¢–û–¢ –ü–ê–†–û–õ–¨ –Ω–∞ —Å–≤–æ–π!
        const ADMIN_PASSWORD = "teacher123";
        let isAdmin = localStorage.getItem('isAdmin') === 'true';
        
        let queue = JSON.parse(localStorage.getItem('savingQueue')) || [];
        let hasJoined = localStorage.getItem('hasJoined') === 'true';

        function updateDisplay() {
            const container = document.getElementById('queueContainer');
            const status = document.getElementById('status');
            const joinBtn = document.getElementById('joinBtn');
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
            queue.sort((a, b) => new Date(a.timestamp) - new Date(b.timestamp));
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—á–µ—Ä–µ–¥–∏
            container.innerHTML = '';
            if (queue.length === 0) {
                container.innerHTML = '<p>–û—á–µ—Ä–µ–¥—å –ø—É—Å—Ç–∞</p>';
            } else {
                queue.forEach((person, index) => {
                    const div = document.createElement('div');
                    div.className = 'queue-item';
                    div.innerHTML = `
                        <span class="number">${index + 1}.</span>
                        <span>${person.name}</span>
                        <span class="timestamp">${new Date(person.timestamp).toLocaleTimeString()}</span>
                    `;
                    container.appendChild(div);
                });
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –∫–Ω–æ–ø–∫–∏
            if (hasJoined) {
                joinBtn.disabled = true;
                const userPosition = queue.findIndex(p => p.name === getUserName()) + 1;
                joinBtn.textContent = '–í—ã —É–∂–µ –≤ –æ—á–µ—Ä–µ–¥–∏!';
                status.innerHTML = `<p>–í–∞—à –Ω–æ–º–µ—Ä –≤ –æ—á–µ—Ä–µ–¥–∏: ${userPosition}</p>`;
            } else {
                joinBtn.disabled = false;
                joinBtn.textContent = '–Ø —Å–¥–∞—é! (+)';
                status.innerHTML = '';
            }

            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Å—ã–ª–∫—É –¥–ª—è –æ–±—â–µ–≥–æ –¥–æ—Å—Ç—É–ø–∞
            updateShareLink();
        }

        function getUserName() {
            let name = localStorage.getItem('userName');
            if (!name) {
                name = prompt('–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è:');
                if (name) {
                    localStorage.setItem('userName', name);
                } else {
                    name = '–ê–Ω–æ–Ω–∏–º';
                }
            }
            return name;
        }

        function joinQueue() {
            if (hasJoined) return;
            
            const name = getUserName();
            const timestamp = new Date().toISOString();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –≤ –æ—á–µ—Ä–µ–¥–∏ –ª–∏ —É–∂–µ —á–µ–ª–æ–≤–µ–∫
            if (!queue.some(person => person.name === name)) {
                queue.push({ name, timestamp });
                hasJoined = true;
                
                localStorage.setItem('savingQueue', JSON.stringify(queue));
                localStorage.setItem('hasJoined', 'true');
                
                updateDisplay();
            }
        }

        function toggleAdmin() {
            if (isAdmin) {
                document.getElementById('adminPanel').style.display = 'block';
            } else {
                const password = prompt('–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∞:');
                if (password === ADMIN_PASSWORD) {
                    isAdmin = true;
                    localStorage.setItem('isAdmin', 'true');
                    document.getElementById('adminPanel').style.display = 'block';
                    alert('–ê–¥–º–∏–Ω-–¥–æ—Å—Ç—É–ø –≤–∫–ª—é—á–µ–Ω!');
                } else {
                    alert('–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!');
                }
            }
        }

        function resetQueue() {
            if (!isAdmin) {
                alert('–¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω –º–æ–∂–µ—Ç —Å–±—Ä–∞—Å—ã–≤–∞—Ç—å –æ—á–µ—Ä–µ–¥—å!');
                return;
            }
            
            if (confirm('–¢–æ—á–Ω–æ —Å–±—Ä–æ—Å–∏—Ç—å –æ—á–µ—Ä–µ–¥—å –¥–ª—è –≤—Å–µ—Ö?')) {
                queue = [];
                hasJoined = false;
                localStorage.removeItem('savingQueue');
                localStorage.removeItem('hasJoined');
                updateDisplay();
                alert('–û—á–µ—Ä–µ–¥—å —Å–±—Ä–æ—à–µ–Ω–∞!');
            }
        }

        function clearMyQueue() {
            const name = getUserName();
            queue = queue.filter(person => person.name !== name);
            hasJoined = false;
            
            localStorage.setItem('savingQueue', JSON.stringify(queue));
            localStorage.setItem('hasJoined', 'false');
            updateDisplay();
            alert('–í—ã –≤—ã—à–ª–∏ –∏–∑ –æ—á–µ—Ä–µ–¥–∏!');
        }

        function updateShareLink() {
            // –°–æ–∑–¥–∞–µ–º —Å—Å—ã–ª–∫—É –¥–ª—è –æ–±—â–µ–≥–æ –¥–æ—Å—Ç—É–ø–∞
            const currentUrl = window.location.href;
            document.getElementById('shareLink').textContent = currentUrl;
        }

        function copyShareLink() {
            const link = document.getElementById('shareLink').textContent;
            navigator.clipboard.writeText(link).then(() => {
                alert('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞! –û—Ç–ø—Ä–∞–≤—å—Ç–µ –µ–µ –æ–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–∞–º');
            });
        }

        // –û–±–Ω–æ–≤–ª—è–µ–º –∫–∞–∂–¥—ã–µ 3 —Å–µ–∫—É–Ω–¥—ã
        setInterval(updateDisplay, 3000);

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        updateDisplay();
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞—Ö–æ–¥–µ
        if (!localStorage.getItem('firstVisit')) {
            alert('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! üìö\n\n–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:\n1. –ù–∞–∂–º–∏—Ç–µ "+" —á—Ç–æ–±—ã –≤—Å—Ç–∞—Ç—å –≤ –æ—á–µ—Ä–µ–¥—å\n2. –ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Å—Å—ã–ª–∫–æ–π —Å –æ–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–∞–º–∏\n3. –ê–¥–º–∏–Ω –º–æ–∂–µ—Ç —Å–±—Ä–∞—Å—ã–≤–∞—Ç—å –æ—á–µ—Ä–µ–¥—å\n\n–ü–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∞: ' + ADMIN_PASSWORD);
            localStorage.setItem('firstVisit', 'true');
        }
    </script>
</body>
</html>